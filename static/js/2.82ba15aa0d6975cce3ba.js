webpackJsonp([2],{"7tir":function(t,e){},iMFA:function(t,e){},u8Gc:function(t,e){},uw9m:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("lC5x"),a=i.n(s),n=i("aA9S"),l=i.n(n),r=i("3cXf"),o=i.n(r),c=i("J0Oq"),v=i.n(c),u=i("gyMJ"),d=i("0xDb"),m={props:["data"],data:function(){return{visible:!0,maskVisible:!0,videoVisible:!1,playing:!1,played_length:0,buffered_length:0,current_time:"00:00",total_time:"00:00",timeout:null,quality:"480",qualityVisible:!1}},computed:{videoUrl:function(){var t=this.data.mv_url;return{360:t[1].url[0]+t[1].cn+"?vkey="+t[1].vkey,480:t[2].url[0]+t[2].cn+"?vkey="+t[2].vkey,720:t[3].url[0]+t[3].cn+"?vkey="+t[3].vkey,1080:t[4].url[0]+t[4].cn+"?vkey="+t[4].vkey}}},filters:{quality_filter:function(t){switch(t){case"360":return"标清";case"480":return"高清";case"720":return"超清";case"1080":return"蓝光"}}},methods:{play:function(){var t=this.$refs.video;this.playing?(t.pause(),clearTimeout(this.timeout)):(t.play(),this.maskVisible=!1)},showControl:function(){var t=this;this.maskVisible=!0,this.playing&&(null!=this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){t.maskVisible=!1},3e3))},fullScreen:function(){this.$refs.video.webkitRequestFullScreen()},progress:function(){var t=this.$refs.video,e=this.$refs.progress.offsetWidth,i=t.buffered;try{var s=i.end(i.length-1)}catch(t){}this.played_length=t.currentTime/t.duration*e,this.buffered_length=s/t.duration*e,this.current_time=Object(d.a)(t.currentTime),this.total_time=Object(d.a)(t.duration),this.playing=!t.paused},setProgress:function(t){var e=this.$refs.video,i=this.$refs.ball.offsetWidth,s=this.$refs.progress.offsetLeft,a=this.$refs.progress.offsetWidth,n=t.clientX-s-i/2;n<0?n=0:n>a?n=a:this.buffered_length>0&&n>this.buffered_length&&(n=this.buffered_length),this.played_length=n,e.currentTime=n/a*e.duration}},watch:{videoVisible:function(t){var e=this;t&&this.$nextTick(function(){var t=e.$refs.video;t.addEventListener("canplay",function(){e.visible=!1,e.maskVisible=!1}),t.addEventListener("error",function(){e.visible=!0,e.videoVisible=!1,e.quality="480"}),t.addEventListener("timeupdate",e.progress)})}}},_={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"video"}},[t.visible?i("div",{staticClass:"cover"},[i("img",{attrs:{src:t.data.cover,alt:""}}),t._v(" "),i("div",{staticClass:"mask"},[i("span",{staticClass:"play-btn",on:{click:function(e){t.videoVisible=!0}}})])]):t._e(),t._v(" "),t.videoVisible?i("div",{staticClass:"video"},[i("video",{ref:"video",attrs:{src:t.videoUrl[t.quality],autoplay:"","webkit-playsinline":""},on:{click:t.showControl}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.maskVisible,expression:"maskVisible"}],staticClass:"mask",on:{click:t.showControl}},[i("span",{class:t.playing?"pause-btn":"play-btn",on:{click:function(e){return e.stopPropagation(),t.play(e)}}}),t._v(" "),i("div",{staticClass:"control"},[i("span",{staticClass:"time"},[t._v(t._s(t.current_time))]),t._v(" "),i("div",{ref:"progress",staticClass:"wrapper",on:{click:function(e){t.setProgress(e)}}},[i("div",{staticClass:"progress"},[i("div",{staticClass:"play-bar",style:{width:t.played_length+"px"}}),t._v(" "),i("div",{staticClass:"buffer-bar",style:{width:t.buffered_length+"px"}}),t._v(" "),i("div",{ref:"ball",staticClass:"ball",style:{left:t.played_length+"px"}})])]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t.total_time))]),t._v(" "),i("span",{staticClass:"text",on:{click:function(e){t.qualityVisible=!0}}},[t._v(t._s(t._f("quality_filter")(t.quality)))]),t._v(" "),i("span",{staticClass:"fullscreen",on:{click:t.fullScreen}})])]),t._v(" "),i("transition",{attrs:{"enter-active-class":"animated slideInRight","leave-active-class":"animated slideOutRight"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.qualityVisible,expression:"qualityVisible"}],staticClass:"quality",on:{click:function(e){t.qualityVisible=!1}}},[i("div",{staticClass:"quality-wrapper"},[i("ul",{staticClass:"quality-list"},[i("li",{staticClass:"quality-item",class:{active:"1080"===t.quality},on:{click:function(e){t.quality="1080"}}},[t._v("蓝光 1080p")]),t._v(" "),i("li",{staticClass:"quality-item",class:{active:"720"===t.quality},on:{click:function(e){t.quality="720"}}},[t._v("超清 720p")]),t._v(" "),i("li",{staticClass:"quality-item",class:{active:"480"===t.quality},on:{click:function(e){t.quality="480"}}},[t._v("高清 480p")]),t._v(" "),i("li",{staticClass:"quality-item",class:{active:"360"===t.quality},on:{click:function(e){t.quality="360"}}},[t._v("标清 360p")])])])])])],1):t._e()])},staticRenderFns:[]};var p=i("vSla")(m,_,!1,function(t){i("7tir")},"data-v-5064f675",null).exports,f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"mv-detail"},[i("p",{staticClass:"title"},[t._v(t._s(t.data.mvname))]),t._v(" "),i("p",{staticClass:"singer",domProps:{innerHTML:t._s(t.data.singers.map(function(t){return"<span id='"+t.mid+"'>"+t.name+"</span>"}).join(" / "))},on:{click:function(e){e.target.id&&t.$router.push("/artist/"+e.target.id)}}}),t._v(" "),i("p",{staticClass:"count"},[t.data.toplist.topnum>0?i("span",{staticClass:"rank",on:{click:function(e){t.$router.push("/toplist/201")}}},[t._v("\n      "+t._s(t.data.toplist.istop?"MV排行第"+t.data.toplist.topnum+"名(第"+t.data.toplist.weekno+"期)":"暂未上榜"))]):t._e(),t._v(" "),i("span",[t._v(t._s(t._f("count_filter")(t.data.listennum))+"次播放")]),t._v(" "),i("span",[t._v(t._s(t.data.pubdate))])]),t._v(" "),i("p",{staticClass:"desc",domProps:{innerHTML:t._s(t.data.desc.replace(/\n/g,"<br>"))}}),t._v(" "),t.data.toplist.score>0?i("p",{staticClass:"score"},[i("span",[t._v("本期得分")]),t._v(" "),i("span",[t._v(t._s(t.data.toplist.score))]),t._v(" "),i("span",[t._v("（本期数据综合评分）")])]):t._e()])},staticRenderFns:[]};var h=i("vSla")({props:["data"],filters:{count_filter:function(t){return t>=1e4?(t/1e4).toFixed(1)+"万":t}}},f,!1,function(t){i("u8Gc")},"data-v-f683edc8",null).exports,y=i("DKky"),g=i("KgXo"),b=i("lVAl"),k={components:{loading:g.a,mvVideo:p,mvDetail:h,mv:y.a,comment:b.a},data:function(){return{mv_info:{},comment_hot:[],comment_new:[],comment_hot_count:0,comment_new_count:0,loading:!0}},computed:{simi_mv:function(){return this.mv_info.simmvlist.list.slice(0,8).map(function(t){return{id:t.vid,title:t.name,pic:t.picurl,artist:t.singers.map(function(t){return t.name}).join("、")}})},singer_mv:function(){return this.mv_info.singermvlist.list.slice(0,8).map(function(t){return{id:t.vid,title:t.name,pic:t.picurl,artist:t.singers.map(function(t){return t.name}).join("、")}})},vid:function(){return this.$route.params.id}},methods:{loadData:function(){var t=this;return v()(a.a.mark(function e(){var i,s,n,r,c,v,d,m,_,p;return a.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=void 0,t.loading=!0,e.next=4,t.$jsonp(u.a.GET_MUSIC,{data:o()({getMvInfo:{module:"MvService.MvInfoProServer",method:"GetMvInfoList",param:{vidlist:[t.vid]}}})});case 4:return s=e.sent,n=s.getMvInfo.data.mvlist,i=n[0].fileid,e.next=9,t.$jsonp(u.a.GET_MV_INFO,{vid:t.vid});case 9:return r=e.sent,c=r.data,t.mv_info=c,e.next=14,t.$jsonp(u.a.GET_MUSIC,{data:o()({getMvUrl:{module:"Mv.MvDownloadUrlServer",method:"GetMvUrls",param:{fileid:[i],filetype:[-1]}}})});case 14:return v=e.sent,d=v.getMvUrl.data.data,t.mv_info=l()(t.mv_info,{mv_url:d[i],cover:n[0].cover_pic}),t.loading=!1,e.next=20,t.$jsonp(u.a.GET_COMMENT,{pagenum:0,cmd:8,topid:t.vid,biztype:5});case 20:m=e.sent,_=m.comment,p=m.hot_comment,t.comment_new=_.commentlist,t.comment_hot=p.commentlist,t.comment_new_count=_.commenttotal,t.comment_hot_count=p.commenttotal;case 27:case"end":return e.stop()}},e,t)}))()}},watch:{$route:"loadData"},mounted:function(){this.loadData()}},C={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"mv"}},[t.loading?t._e():i("div",[i("mv-video",{attrs:{data:t.mv_info}}),t._v(" "),i("mv-detail",{attrs:{data:t.mv_info}}),t._v(" "),t.singer_mv.length>0?i("p",{staticClass:"title"},[t._v("同艺人的其他MV")]):t._e(),t._v(" "),i("mv",{attrs:{data:t.singer_mv}}),t._v(" "),t.simi_mv.length>0?i("p",{staticClass:"title"},[t._v("相关MV")]):t._e(),t._v(" "),i("mv",{attrs:{data:t.simi_mv}}),t._v(" "),i("comment",{staticStyle:{"padding-top":"1rem"},attrs:{data:t.comment_hot,title:"最热评论 "+t.comment_hot_count}},[i("router-link",{attrs:{to:/comment/+t.vid+"?type=mv"}},[t._v("更多")])],1),t._v(" "),i("comment",{staticStyle:{"padding-top":"1rem"},attrs:{data:t.comment_new,title:"最新评论 "+t.comment_new_count}},[i("router-link",{attrs:{to:/comment/+t.vid+"?type=mv"}},[t._v("更多")])],1)],1),t._v(" "),t.loading?i("loading"):t._e()],1)},staticRenderFns:[]};var w=i("vSla")(k,C,!1,function(t){i("iMFA")},"data-v-47c65dbc",null);e.default=w.exports}});